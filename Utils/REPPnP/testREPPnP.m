Point3D = [ 0.32219096, -3.02094907,  0.81705429;
       -0.39811431,  2.1354375 ,  1.88200622;
        0.3982418 , -2.89691376,  0.93154176;
        0.17666699, -1.24050861,  1.62904623;
        0.32219096, -3.02094907,  0.81705429;
        0.12379683, -1.35744204,  1.65377365;
        0.3309625 , -3.03089893,  0.91266759;
        0.3084111 , -2.6747971 ,  1.51551975;
        0.14816254, -0.84349059,  2.05093831;
       -0.01911442, -0.63544271,  0.16537842;
        4.52002299,  7.56918947,  0.33228483;
        0.25250859, -2.52527868,  0.61361579;
       -0.10915973,  0.3990766 ,  0.94513866;
       -0.25076791,  1.11407218,  0.47552502;
        0.26922274, -2.29420986,  1.91795053;
       -0.23896022,  1.49994089,  1.21935734;
        0.03989464, -0.90601176,  1.50043951;
       -0.10915973,  0.3990766 ,  0.94513866;
        0.17201874, -1.27863066,  1.72581103;
        0.31395858, -2.44059951,  0.75892952;
        0.26922274, -2.29420986,  1.91795053;
        3.86781649,  7.37707218,  1.31822823;
        0.23605421, -1.99722353,  0.67522346;
       -0.01911442, -0.63544271,  0.16537842;
        0.04776427, -0.59769247,  0.50838555;
        0.1761357 , -2.02551164,  0.34911405;
        0.33695471, -3.03677354,  0.97485071;
        0.15208525, -0.9695249 ,  2.50677838;
        0.31664882, -2.71116188,  0.71131116;
        0.33695471, -3.03677354,  0.97485071;
        0.1544073 ,  0.05959558,  2.96994592;
        0.24962136, -1.95410092,  1.61012114;
        0.23605421, -1.99722353,  0.67522346;
        0.11251279, -0.92686135,  2.08298144;
        0.19471202, -0.63919667,  2.67067129;
       -0.41195209,  2.15437155,  1.72016994;
        0.18688311, -0.83216471,  2.28530453;
       -0.31105715,  2.11915176,  1.56498312;
        0.22269559, -0.85654606,  2.62049333;
       -0.06006647, -0.43590955,  1.17050826;
        0.11709665, -0.46727409,  2.52545371;
       -0.32893483,  1.75161572,  0.71609363;
        0.11251279, -0.92686135,  2.08298144;
        0.26801427, -1.03684555,  2.56659161;
        0.13149886, -1.24704705,  1.33298183;
        0.26057155, -2.43808441,  1.35999562;
        0.04881602, -0.65787895,  1.70608333;
        0.35632926, -2.59026416,  1.56597788;
       -0.2580401 ,  1.4456819 ,  1.26925401;
        0.27526717, -2.26531098,  1.86235953];


Point2D = [  56.09667969,  349.21972656;
       587.55169678,  292.02566528;
        74.68115234,  337.85409546;
       272.04119873,  279.89828491;
        56.09667969,  349.21972656;
       257.81045532,  275.72341919;
        56.18503189,  337.36608887;
       105.97982788,  274.33248901;
       319.36566162,  240.08457947;
       314.48809814,  437.49578857;
       306.66125488,  559.06665039;
       113.33959198,  377.29937744;
       425.86688232,  366.17669678;
       483.99664307,  417.13638306;
       156.4178772 ,  234.89242554;
       528.94549561,  348.24887085;
       302.63311768,  297.550354  ;
       425.86688232,  366.17669678;
       268.40719604,  270.16912842;
       127.23138428,  361.89971924;
       156.4178772 ,  234.89242554;
       253.41748047,  441.66073608;
       176.76986694,  375.60107422;
       314.48809814,  437.49578857;
       324.33267212,  403.05862427;
       168.44404602,  410.14926147;
        56.11099243,  331.45077515;
       310.35992432,  190.83338928;
        93.65132141,  365.11242676;
        56.11099243,  331.45077515;
       424.72476196,  157.2494812 ;
       193.53637695,  273.74313354;
       176.76986694,  375.60107422;
       309.6947937 ,  236.0629425 ;
       349.73095703,  177.94645691;
       587.02563477,  306.01776123;
       323.66326904,  215.38528442;
       585.91644287,  321.26974487;
       327.49905396,  180.01029968;
       345.61868286,  336.2401123 ;
       362.77923584,  195.89187622;
       541.84014893,  398.76208496;
       309.6947937 ,  236.0629425 ;
       308.1423645 ,  182.45181274;
       266.52038574,  311.66165161;
       132.19120789,  294.51724243;
       332.22796631,  278.85473633;
       117.87982941,  269.35247803;
       523.74481201,  343.7746582 ;
       159.1558075 ,  241.60708618];

K_gt = [1452.5, 0.0, 664.0;
        0.0, 1452.5, 373.5;
        0.0, 0.0, 1.0];

RT_gt = [0.4118515868930353, 0.9018593105232651, 0.13049158745371142, -2.814677229539918;
    0.11257265065973066, 0.09174930045345209, -0.9893985365815661, 0.8394255807294836;
    -0.9042707938981172, 0.42217514124922517, -0.06373759811968088, 14.288014355063137];

U = Point3D';
u = K_gt \ [Point2D , ones(size(Point2D,1),1)]';
u = u(1:2,:);

mU = U - repmat(mean(U,2),1,size(U,2));
[R, T, mask] = REPPnP(mU,u);
T = T - R * mean(U,2);
tcost = toc * 1000;
method_list(1).mask_inliers = mask;

